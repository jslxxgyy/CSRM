<div align="center">

<h2>Cities Skylines Radio Manager，CSRM</h2>
<h3>一个《都市：天际线 2》电台制作软件。<br></h3>
简体中文丨<a href="https://github.com/jslxxgyy/CSRM/blob/main/docs/en/Readme.md">English</a>

</div>

> [!CAUTION]
> **本软件由易语言编写，会有杀毒软件误报的情况，本项目保证软件中没有任何恶意代码，请自行添加信任区。编译结果已尽量作打乱处理。**


---

本软件与都市天际线2模组ExtendedRadio配套使用，可根据输入的内容一键生成自定义电台目录树及对应的json配置文件，无需手动编辑 json 文件即可在游戏中创建自定义电台，并可导入/导出电台。软件自带 ffmpeg，可以将音频文件转换为游戏需要的 .ogg 格式。

> [!TIP]
> 在使用此软件前，请确保已安装 cities-skylines-2 模组 [ExtendedRadio](https://www.cslbbs.net/resources/extendedradio.326/)并能被正常加载。本软件可从CSUL的配置中读取游戏数据目录，建议与CSUL安装在同目录下。

## 使用方法:
### 新建电台：
- 1.首次启动，设置好游戏数据目录和临时文件目录。
- 2.点击新建电台，打开电台新建窗口。
- 3.填写自定义电台信息，标*的为必填。
其中：
- 电台名称会显示在图中①处
- 电台描述会显示在图中②处
- 频道名称会显示在图中③处
- 频道描述会显示在图中④处
- 节目名称会显示在图中⑤处
- 节目描述会显示在图中⑥处
- 开始时间和结束时间会显示在图中⑦处


<div align="center">
  
<img  src="https://gitee.com/jslxxgyy/CSRM/raw/main/docs/network.png" alt="这就是一张图片" >

</div>

> [!TIP]
> 如果不填写开始时间和结束时间，那么⑦处对应的时间和进度条不会变化。

在以上信息填写完毕后，即可点击右方的“添加／更改”按钮向对应的电台节目中添加音乐。这一环节支持几乎所有的音频格式，非`.ogg`文件会在新建电台时调用ffmpeg自动转换。
点击新建电台按钮即可生成电台。生成的电台位置由在设置中填写的游戏数据目录所决定。在生成完成后可选择导出电台，在输出文件夹中生成`output.zip`文件。
在提示“电台新建完成”后即可在ExtendedRadio模组设置中重新加载电台，或重启游戏以重新加载模组。

也可访问www.bilibili.com/video/BV1Hvh1evEuw/获取[视频教程](https://www.bilibili.com/video/BV1Hvh1evEuw/)


## 设置说明：
- 模组类型由用户安装的模组来源自行决定。支持PMOD版和BeplnEx版。不同的版本会要求填写不同的游戏相关路径。如果与CSUL安装在同一目录，可从CSUL的配置文件中依据模组类型自动读取路径。
> [!WARNING]
> 从0.3.0版本开始，会停止BeplnEx版模组的支持。

- 临时文件目录是软件运行时的重要目录，会存储在电台创建过程中的关键文件。建议使用“程序目录下的临时目录”选项，或在自定义时设置一个简明易记的位置。在报告问题时需提供完整的临时文件目录内容。
## 功能计划:
- [x] 新建单频道单节目多音乐的电台
- [x] 使用CSUL的配置文件设置游戏相关目录
- [x] 使用ffmpeg转换不为`.ogg`格式的音乐
- [x] 导出zip格式的电台包。
- [ ] 一键导入zip格式的电台包
- [ ] 支持自定义电台图标
- [ ] 修改现有电台
- [ ] 新建多频道多节目多音乐的电台
## 问题反馈：
如程序运行过程中出现任何问题，请在备份后清除游戏自定义电台文件目录后再次尝试。若问题仍然存在，请于[CSLBBS](https://www.cslbbs.net/threads/cities-skylines-radio-manager.1053/)提交反馈。考虑到国内访问GitHub较为困难，会优先处理CSLBBS上的问题。
最近CSLBBS出现了访问不稳定的问题，如果无法访问CSLBBS，则请移步至GitHub提交问题。
### 在提交问题时：
- 需提供详细的问题说明或提供问题出现的视频或截图
- 需写明程序的版本号及编译时间
- 需上传程序运行目录下的`load.ini`文件
- 临时文件目录中有文件需一并上传

## 仓库结构及开发流程说明

CSRM项目采取双分支并行的开发模式。main分支为主分支，另一个分支为测试分支，名称为下一版本的的开发代号。所有的功能与性能改进都会优先推送到该分支，当测试分支成熟时，就会PR到主分支，并在稍后放出release。当一个release有缺陷时，补丁会直接推送到主分支，放出fix的release，并会在稍后合并补丁到测试分支。

### 自行编译

想体验测试分支中没有release的功能，可以先安装最新的release，再把测试分支中的文件拉取放在正式版的release中，在自行编译时替换掉原本的主程序即可，这样可以最大限度的避免依赖问题。CSRM依赖精易模块，请确保自行编译时准备好该模块。准备好了这些以后，你也有了一个适用于CSRM的开发环境，为什么不提交一个PR呢?

### 你这代码保熟吗？
这是我的第一个GitHub项目，现在仍在早期阶段，代码中有很多细节问题，我也无法确保测试到每一种情况，难免会有疏漏之处。如果你对这个项目有意见或想贡献代码，欢迎提交PR/issue!(后面项目会用C#重写喔)

